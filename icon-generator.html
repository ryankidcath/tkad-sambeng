<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Generate PWA Icons (Logo Kabupaten Cirebon)</title>
  <style>
    body { font-family: system-ui, sans-serif; padding: 1.5rem; max-width: 32rem; margin: 0 auto; }
    h1 { font-size: 1.25rem; margin-bottom: 0.5rem; }
    p { color: #475569; font-size: 0.875rem; margin-bottom: 1rem; }
    .preview { display: flex; gap: 1rem; flex-wrap: wrap; margin-bottom: 1rem; }
    .preview canvas { border: 1px solid #e2e8f0; border-radius: 0.5rem; }
    .preview figcaption { font-size: 0.75rem; color: #64748b; margin-top: 0.25rem; }
    button { padding: 0.5rem 1rem; margin-right: 0.5rem; margin-bottom: 0.5rem; cursor: pointer; background: #166534; color: #fff; border: none; border-radius: 0.375rem; font-size: 0.875rem; }
    button:hover { background: #14532d; }
    .status { font-size: 0.8125rem; color: #64748b; margin-top: 1rem; }
  </style>
</head>
<body>
  <h1>Ikon PWA (Logo Kabupaten Cirebon)</h1>
  <p>Logo dari <code>images/logo-kab-cirebon.png</code> ditempatkan di atas background tema. Buka file ini lewat server lokal (mis. <code>npx serve .</code>) agar gambar bisa dimuat, lalu unduh kedua ikon dan ganti file di folder <code>icons/</code>.</p>
  <div class="preview">
    <figure>
      <canvas id="c192" width="192" height="192"></canvas>
      <figcaption>192×192</figcaption>
    </figure>
    <figure>
      <canvas id="c512" width="512" height="512"></canvas>
      <figcaption>512×512</figcaption>
    </figure>
  </div>
  <button type="button" id="dl192">Unduh icon-192.png</button>
  <button type="button" id="dl512">Unduh icon-512.png</button>
  <p class="status" id="status">Memuat logo…</p>

  <script>
    (function () {
      var BACKGROUND = '#166534';
      var PADDING = 0.12;

      function drawIcon(canvas, size) {
        var ctx = canvas.getContext('2d');
        ctx.fillStyle = BACKGROUND;
        ctx.fillRect(0, 0, size, size);
        return ctx;
      }

      function drawLogo(ctx, img, size) {
        var pad = size * PADDING;
        var w = size - pad * 2;
        var h = size - pad * 2;
        ctx.drawImage(img, pad, pad, w, h);
      }

      function render(img) {
        var c192 = document.getElementById('c192');
        var c512 = document.getElementById('c512');
        drawIcon(c192.getContext('2d'), 192);
        drawIcon(c512.getContext('2d'), 512);
        drawLogo(c192.getContext('2d'), img, 192);
        drawLogo(c512.getContext('2d'), img, 512);
      }

      function download(canvas, filename) {
        var a = document.createElement('a');
        a.download = filename;
        a.href = canvas.toDataURL('image/png');
        a.click();
      }

      var img = new Image();
      img.crossOrigin = 'anonymous';
      img.onload = function () {
        render(img);
        document.getElementById('status').textContent = 'Logo berhasil dimuat. Unduh ikon lalu ganti file di icons/';
      };
      img.onerror = function () {
        document.getElementById('status').textContent = 'Gagal memuat logo. Pastikan images/logo-kab-cirebon.png ada dan buka halaman ini lewat server lokal (mis. npx serve .).';
      };
      img.src = 'images/logo-kab-cirebon.png';

      document.getElementById('dl192').addEventListener('click', function () {
        download(document.getElementById('c192'), 'icon-192.png');
      });
      document.getElementById('dl512').addEventListener('click', function () {
        download(document.getElementById('c512'), 'icon-512.png');
      });
    })();
  </script>
</body>
</html>
